# Photolab Background Remover

–°–µ—Ä–≤–∏—Å —É–¥–∞–ª–µ–Ω–∏—è —Ñ–æ–Ω–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ AI. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Replicate API –∏ FastAPI.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–Ω (–æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π, 15-20 –º–∏–Ω—É—Ç)

**–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –¥–µ–ø–ª–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Å—Ç–∞—Ä—Ç–∞):** [docs/DEPLOY_SIMPLE.md](docs/DEPLOY_SIMPLE.md)  
–ë–µ–∑ S3/—Ö—Ä–∞–Ω–∏–ª–∏—â–∞. –ù—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ Replicate —Ç–æ–∫–µ–Ω. –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞ free tier.

**–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –¥–µ–ø–ª–æ–π (—Å S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º):**  
- Backend: [docs/DEPLOY.md](docs/DEPLOY.md) ‚Äî Render.com + Cloudflare R2  
- Frontend: [docs/DEPLOY_FRONTEND.md](docs/DEPLOY_FRONTEND.md) ‚Äî Vercel

**–û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏ (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç):**
1. –ü–æ–ª—É—á–∏—Ç—å Replicate API —Ç–æ–∫–µ–Ω
2. –ó–∞–ª–∏—Ç—å –∫–æ–¥ –Ω–∞ GitHub
3. –ü–æ–¥–∫–ª—é—á–∏—Ç—å backend –∫ Render.com —á–µ—Ä–µ–∑ Blueprint
4. –ü–æ–¥–∫–ª—é—á–∏—Ç—å frontend –∫ Vercel
5. –ó–∞–¥–∞—Ç—å —Ç–æ–∫–µ–Ω Replicate –≤ –æ–±–æ–∏—Ö Dashboard
6. –ì–æ—Ç–æ–≤–æ! –°–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `https://your-app.vercel.app`

---

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

**Backend:**
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ env.sample –≤ .env –∏ –∑–∞–¥–∞–π—Ç–µ REPLICATE_API_TOKEN
docker-compose up --build
# API: http://localhost:8000
```

**Frontend:**
```bash
cd frontend
npm install
npm run dev
# UI: http://localhost:3000
```

---

## üìö –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Backend:** FastAPI + Uvicorn
- **Frontend:** Next.js 14 + TypeScript + Tailwind CSS
- **ML API:** Replicate ([851-labs/background-remover](https://replicate.com/collections/remove-backgrounds))
- **Queue:** Redis + RQ (–¥–ª—è batch –æ–±—Ä–∞–±–æ—Ç–∫–∏)
- **Storage:** –í –ø–∞–º—è—Ç–∏ (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è) –∏–ª–∏ S3-compatible (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **Deploy:** Render.com (backend) + Vercel (frontend), auto-deploy –∏–∑ GitHub

---

## üîå API Endpoints

### `GET /health`
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞.

**–û—Ç–≤–µ—Ç:**
```json
{"status": "ok"}
```

---

### `POST /remove-bg`
–£–¥–∞–ª–∏—Ç—å —Ñ–æ–Ω —Å –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `file` (multipart) ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (JPEG/PNG/WebP, –¥–æ 15MB)
- `mode` (optional) ‚Äî `quality` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏–ª–∏ `fast`

**–û—Ç–≤–µ—Ç:**
```json
{
  "object_key": "results/abc123.png",
  "download_url": "https://...presigned-url...",
  "expires_in": 86400
}
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -X POST http://localhost:8000/remove-bg \
  -F "file=@photo.jpg" \
  -F "mode=quality"
```

---

### `POST /batch`
–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ).

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `files` (multipart array) ‚Äî —Å–ø–∏—Å–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `mode` (optional) ‚Äî `quality` –∏–ª–∏ `fast`

**–û—Ç–≤–µ—Ç:**
```json
{
  "job_id": "abc-123-def",
  "status": "queued"
}
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -X POST http://localhost:8000/batch \
  -F "files=@img1.jpg" \
  -F "files=@img2.png" \
  -F "mode=fast"
```

---

### `GET /batch/{job_id}`
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∏ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã batch –∑–∞–¥–∞—á–∏.

**–û—Ç–≤–µ—Ç (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ):**
```json
{
  "status": "started",
  "progress": "2/5"
}
```

**–û—Ç–≤–µ—Ç (–∑–∞–≤–µ—Ä—à–µ–Ω–æ):**
```json
{
  "status": "finished",
  "results": [
    {
      "filename": "img1.jpg",
      "object_key": "batch/img1.jpg",
      "download_url": "https://...presigned-url..."
    },
    ...
  ]
}
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Å–º. `env.sample`):

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------------------|----------|
| `REPLICATE_API_TOKEN` | - | API —Ç–æ–∫–µ–Ω Replicate (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) |
| `REPLICATE_MODEL_QUALITY` | `851-labs/background-remover` | –ú–æ–¥–µ–ª—å –¥–ª—è `mode=quality` |
| `REPLICATE_MODEL_FAST` | `lucataco/remove-bg` | –ú–æ–¥–µ–ª—å –¥–ª—è `mode=fast` |
| `MAX_FILE_SIZE_MB` | `15` | –ú–∞–∫—Å —Ä–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ |
| `MAX_DIMENSION` | `3072` | –ê–≤—Ç–æ-—Ä–µ—Å–∞–π–∑ –ø–æ –¥–ª–∏–Ω–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–µ |
| `REDIS_URL` | `redis://redis:6379/0` | Redis connection string |
| `S3_ENDPOINT_URL` | `http://minio:9000` | S3/R2 endpoint |
| `S3_ACCESS_KEY` | `minioadmin` | S3 access key |
| `S3_SECRET_KEY` | `minioadmin` | S3 secret key |
| `S3_BUCKET_NAME` | `photolab` | –ù–∞–∑–≤–∞–Ω–∏–µ bucket |
| `PRESIGNED_URL_EXPIRATION` | `86400` | –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Å—Å—ã–ª–æ–∫ (—Å–µ–∫) |

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Photolab/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI routes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py            # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (pydantic)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ replicate_client.py  # –û–±—ë—Ä—Ç–∫–∞ Replicate API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ storage.py           # S3/MinIO –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ worker.py                # RQ worker –¥–ª—è batch
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx             # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx           # Layout
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ globals.css          # –°—Ç–∏–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ImageUploader.tsx    # –ó–∞–≥—Ä—É–∑–∫–∞ –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ImagePreview.tsx     # –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–æ/–ø–æ—Å–ª–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BatchUploader.tsx    # –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.ts               # API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ next.config.js
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ DEPLOY.md                # –î–µ–ø–ª–æ–π backend
‚îÇ   ‚îî‚îÄ‚îÄ DEPLOY_FRONTEND.md       # –î–µ–ø–ª–æ–π frontend
‚îú‚îÄ‚îÄ docker-compose.yml           # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
‚îú‚îÄ‚îÄ render.yaml                  # –ö–æ–Ω—Ñ–∏–≥ Render.com
‚îú‚îÄ‚îÄ vercel.json                  # –ö–æ–Ω—Ñ–∏–≥ Vercel
‚îú‚îÄ‚îÄ env.sample                   # –ü—Ä–∏–º–µ—Ä –æ–∫—Ä—É–∂–µ–Ω–∏—è backend
‚îî‚îÄ‚îÄ README.md
```

---

## üõ†Ô∏è Roadmap

### ‚úÖ –§–∞–∑–∞ 1: MVP Backend (–≥–æ—Ç–æ–≤–æ)
- [x] FastAPI + —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã `/remove-bg`, `/batch`
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Replicate API
- [x] –û—á–µ—Ä–µ–¥—å batch (Redis + RQ)
- [x] S3/MinIO —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- [x] –î–µ–ø–ª–æ–π –Ω–∞ Render.com

### ‚úÖ –§–∞–∑–∞ 2: Frontend (–≥–æ—Ç–æ–≤–æ)
- [x] Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å TypeScript
- [x] Drag-n-drop –∑–∞–≥—Ä—É–∑–∫–∞
- [x] –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–æ/–ø–æ—Å–ª–µ
- [x] Batch –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
- [x] –î–µ–ø–ª–æ–π –Ω–∞ Vercel

### üöß –§–∞–∑–∞ 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–≤ –ø–ª–∞–Ω–∞—Ö)
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ö–µ—à—É –≤—Ö–æ–¥–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥—É–±–ª–µ–π
- [ ] Rate limiting –ø–æ IP –¥–ª—è –≥–æ—Å—Ç–µ–π
- [ ] –°–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ Replicate
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry –¥–ª—è –æ—à–∏–±–æ–∫)

### üöß –§–∞–∑–∞ 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç (–≤ –ø–ª–∞–Ω–∞—Ö)
- [ ] –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (magic link/OAuth)
- [ ] –ò—Å—Ç–æ—Ä–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] –®–∞–±–ª–æ–Ω—ã —Ñ–æ–Ω–æ–≤ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ñ–æ–Ω–∞ –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è)
- [ ] –†–µ–¥–∞–∫—Ç–æ—Ä —Å –æ–±—Ä–µ–∑–∫–æ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

### üöß –§–∞–∑–∞ 5: SEO & –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è (–≤ –ø–ª–∞–Ω–∞—Ö)
- [ ] –ë–ª–æ–≥/—Å—Ç–∞—Ç—å–∏ –¥–ª—è SEO (Next.js MDX)
- [ ] –ö–∞—Å—Ç–æ–º–Ω—ã–π –¥–æ–º–µ–Ω
- [ ] –¢–∞—Ä–∏—Ñ—ã/–ø–æ–¥–ø–∏—Å–∫–∏ (Stripe)
- [ ] API –∫–ª—é—á–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- [ ] –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞ –∏ Google Analytics

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

### –õ–æ–∫–∞–ª—å–Ω–æ
–ë–µ—Å–ø–ª–∞—Ç–Ω–æ (Docker –Ω–∞ —Å–≤–æ–µ–π –º–∞—à–∏–Ω–µ)

### –ü—Ä–æ–¥–∞–∫—à–Ω (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ S3)
- **Render.com Free Tier:** Web + Worker + Redis = $0/–º–µ—Å (750—á –∫–∞–∂–¥—ã–π, —Å–ø—è—Ç –ø–æ—Å–ª–µ 15 –º–∏–Ω)
- **Render.com Starter:** $7/–º–µ—Å –∑–∞ —Å–µ—Ä–≤–∏—Å –±–µ–∑ —Å–Ω–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)
- **Vercel Free Tier:** Frontend —Ö–æ—Å—Ç–∏–Ω–≥ = $0/–º–µ—Å (100GB bandwidth)
- **Replicate:** pay-per-use (~$0.001-0.01 –∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏)

**–ò—Ç–æ–≥–æ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ (100-1000 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å):** $0/–º–µ—Å + —Å—Ç–æ–∏–º–æ—Å—Ç—å Replicate –ø–æ —Ñ–∞–∫—Ç—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á—ë—Ç–∞ (—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞):**
- 500 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å √ó 30 –¥–Ω–µ–π = 15,000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–º–µ—Å—è—Ü
- Replicate (851-labs/background-remover): ~$0.002/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ = ~$30/–º–µ—Å
- Render Starter (Web + Worker): $14/–º–µ—Å
- **–ò—Ç–æ–≥–æ: ~$44/–º–µ—Å**

### –ü—Ä–æ–¥–∞–∫—à–Ω (—Å S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤)
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: Cloudflare R2 ($0-5/–º–µ—Å) –∏–ª–∏ AWS S3 (–æ—Ç $5/–º–µ—Å)

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT (–º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –ø–æ–¥ —Å–≤–æ—é)

---

## ü§ù –í–∫–ª–∞–¥

Pull requests –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è! –î–ª—è –±–æ–ª—å—à–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–Ω–∞—á–∞–ª–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ issue –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è.

